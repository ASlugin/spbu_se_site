{% extends "base_dark.html" %}
{% block title %}Курсовые и выпускные квалификационные работы студентов Кафедры Системного Программирования{% endblock %}
{% block description %}Список курсовых и выпускных квалификационных работ бакалавров и магистров Кафедры Системного программирования Математико-механического факультета СПбГУ.{% endblock %}

{% block headers %}
<link rel="canonical" href="https://se.math.spbu.ru/theses.html"/>
{% endblock %}

{% block content %}
    <!-- Main content -->
    <section class="slice pt-8 bg-dark bg-cover bg-size--cover" style="background-image: url({{ url_for('static', filename='/assets/img/main-back.jpg')}});">
        <!-- Container -->
        <div class="container d-flex align-items-center text-center text-lg-left pt-5 pt-lg-6">
            <div class="col px-0">
                <div class="row align-items-center">
                    <div class="col-lg-12 text-center">
                        <!-- Heading -->
                        <h1 class="text-white mb-1">
                            Курсовые и выпускные квалификационные работы
                        </h1>
                    </div>
                </div>
                <div class="row align-items-center">
                    <div class="col-lg-12 text-center">
                        <!-- Text -->
                        <p class="lead text-white opacity-8 mt-2">
                            Курсовые и выпускные квалификационные работы студентов Кафедры Системного Программирования с 2009 по 2021 год.
                        </p>
                    </div>
                </div>
            </div>
        </div>

    </section>

    <section class="slice clients delimiter-top delimiter-bottom bg-section-secondary" id="theses">
        <div class="container">
            <div class="row row-grid">
                <div class="col-lg-9" id="ThesisList">
                    {% for t in theses %}
                    <div class="card border-0">
                        <div class="card-header">
                            <div class="row align-items-center">
                                <div class="col">
                                    <h6 class="mb-0"><strong>{{ t.name_ru }} [{{ t.publish_year }}]</strong></h6>
                                </div>
                                <div class="col-auto ml-auto text-right">
                                    {% if t.text_uri %}
                                    <a href="{{ url_for('static', filename='/thesis/texts/' + t.text_uri) }}" class="text-reset">
                                        <div class="icon icon-sm icon-shape bg-soft-success text-success" data-content="Текст работы" data-placement="top" data-trigger="hover" data-toggle="popoverhover">
                                            <i class="fas fa-file-pdf"></i>
                                        </div>
                                    </a>
                                    {% endif %}
                                    {% if t.presentation_uri %}
                                    <a href="{{ url_for('static', filename='/thesis/presentations/' + t.presentation_uri) }}" class="text-reset">
                                        <div class="icon icon-sm icon-shape bg-soft-warning text-warning" data-content="Презентация" data-placement="top" data-trigger="hover" data-toggle="popoverhover">
                                            <i class="fas fa-file-powerpoint"></i>
                                        </div>
                                    </a>
                                    {% endif %}
                                    {% if t.supervisor_review_uri %}
                                    <a href="{{ url_for('static', filename='/thesis/reviews/' + t.supervisor_review_uri) }}" class="text-reset">
                                        <div class="icon icon-sm icon-shape bg-soft-primary text-primary" data-content="Отзыв руководителя" data-placement="top" data-trigger="hover" data-toggle="popoverhover">
                                            <i class="fas fa-file-alt"></i>
                                        </div>
                                    </a>
                                    {% endif %}
                                    {% if t.supervisor_review_uri %}
                                    <a href="{{ url_for('static', filename='/thesis/reviews/' + t.reviewer_review_uri) }}" class="text-reset">
                                        <div class="icon icon-sm icon-shape bg-soft-primary text-primary" data-content="Отзыв рецензента" data-placement="top" data-trigger="hover" data-toggle="popoverhover">
                                            <i class="fas fa-file-alt"></i>
                                        </div>
                                    </a>
                                    {% endif %}
                                    {% if t.source_uri %}
                                    <a href="{{t.source_uri}}" target="_blank" class="text-reset">
                                        <div class="icon icon-sm icon-shape bg-soft-success text-success" data-content="Реализация" data-placement="top" data-trigger="hover" data-toggle="popoverhover">
                                            <i class="fas fa-file-archive"></i>
                                        </div>
                                    </a>
                                    {% endif %}
                                </div>
                            </div>
                        </div>
                        <div class="card-body pt-2">
                            <p class="text-sm mb-0">Автор: <i>{{t.author}}</i></p>
                            <p class="text-sm mb-0">Руководитель: <i>{{t.supervisor.user.get_name()}}</i></p>
                            <p class="text-sm">Направление: <i>{{t.course.name}}</i></p>
                            {% for tag in t.tags %}
                            <a href="#" class="badge badge-info mr-2">
                                {{ tag.name }}
                            </a>
                            {% endfor %}
                        </div>
                    </div>
                    {% endfor %}
                </div>
                <div class="col-lg-3 ml-lg-auto">
                    <div data-toggle="sticky" data-sticky-offset="10">
                        <div class="card">
                            <div class="card-header px-3">
                                <span class="h6 mb-0">Фильтры</span>
                            </div>
                            <div class="card-body px-3">
                                <p class="text-sm mb-0">
                                    Тип работы
                                </p>
                                <div class="form-group">
                                    {{ filter.csrf_token }}
                                    {{ filter.worktype(class_="custom-select pl-3") }}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
     </section>

    <script>
    let theses_list = document.getElementById('ThesisList');
    let wt_select = document.getElementById('worktype');

    function update() {

        let params = new URLSearchParams();
        let wt = wt_select.value;
        if (wt > 1)
        {
            params.append('worktype', wt);
        }
        console.log(wt);
        console.log('fetch_theses?' + params.toString());

        fetch('fetch_theses?' + params.toString()).then(function(response){
            response.text().then(function (text) {
                theses_list.innerHTML = text;
            });
        });
    }

    wt_select.onchange = update;
    </script>

{% endblock %}
